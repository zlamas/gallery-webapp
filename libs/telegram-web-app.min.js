(()=>{var n={},e="";try{e=location.hash.toString()}catch(e){}var t=l(e),r=b("initParams");if(r)for(var o in r)void 0===t[o]&&(t[o]=r[o]);d("initParams",t);var i,a=!1;try{if(a=null!=window.parent&&window!=window.parent){window.addEventListener("message",function(e){if(e.source===window.parent){try{var t=JSON.parse(e.data)}catch(e){return}if(t&&t.eventType)if("set_custom_style"==t.eventType)"https://web.telegram.org"===e.origin&&(i.innerHTML=t.eventData);else if("reload_iframe"==t.eventType){try{window.parent.postMessage(JSON.stringify({eventType:"iframe_will_reload"}),"*")}catch(e){}location.reload()}else p(t.eventType,t.eventData)}}),i=document.createElement("style"),document.head.appendChild(i);try{window.parent.postMessage(JSON.stringify({eventType:"iframe_ready",eventData:{reload_supported:!0}}),"*")}catch(e){}}}catch(e){}function s(t){try{return t=t.replace(/\+/g,"%20"),decodeURIComponent(t)}catch(e){return t}}function l(e){var t={};if((e=e.replace(/^#/,"")).length)if(e.indexOf("=")<0&&e.indexOf("?")<0)t._path=s(e);else{var r,o,n=e.indexOf("?"),i=(0<=n&&(r=e.substr(0,n),t._path=s(r),e=e.substr(n+1)),c(e));for(o in i)t[o]=i[o]}return t}function c(e){var t={};if(e.length)for(var r,o,n=e.split("&"),i=0;i<n.length;i++)r=s((o=n[i].split("="))[0]),o=null==o[1]?null:s(o[1]),t[r]=o;return t}function p(t,r){console.log("[Telegram.WebView] < receiveEvent",t,r),u(t,function(e){e(t,r)})}function u(e,t){var r=n[e];if(void 0!==r&&r.length)for(var o=0;o<r.length;o++)try{t(r[o])}catch(e){}}function d(e,t){try{return window.sessionStorage.setItem("__telegram__"+e,JSON.stringify(t)),!0}catch(e){}return!1}function b(e){try{return JSON.parse(window.sessionStorage.getItem("__telegram__"+e))}catch(e){}return null}window.Telegram||(window.Telegram={}),window.Telegram.WebView={initParams:t,isIframe:a,onEvent:function(e,t){void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},offEvent:function(e,t){void 0!==n[e]&&-1!==(t=n[e].indexOf(t))&&n[e].splice(t,1)},postEvent:function(e,t,r){if(t=t||function(){},void 0===r&&(r=""),console.log("[Telegram.WebView] > postEvent",e,r),void 0!==window.TelegramWebviewProxy)TelegramWebviewProxy.postEvent(e,JSON.stringify(r)),t();else if(window.external&&"notify"in window.external)window.external.notify(JSON.stringify({eventType:e,eventData:r})),t();else if(a)try{window.parent.postMessage(JSON.stringify({eventType:e,eventData:r}),"*"),t()}catch(e){t(e)}else t({notAvailable:!0})},receiveEvent:p,callEventCallbacks:u},window.Telegram.Utils={urlSafeDecode:s,urlParseQueryString:c,urlParseHashParams:l,urlAppendHashParams:function(e,t){var r=e.indexOf("#");return r<0?e+"#"+t:0<=(r=e.substr(r+1)).indexOf("=")||0<=r.indexOf("?")?e+"&"+t:0<r.length?e+"?"+t:e+t},sessionStorageSet:d,sessionStorageGet:b},window.TelegramGameProxy_receiveEvent=p,window.TelegramGameProxy={receiveEvent:p}})(),(()=>{var p=window.Telegram.Utils,k=window.Telegram.WebView,T=k.initParams,j=k.isIframe,r={},L="",U={},P={},N="light",u="6.0",D="unknown",R=!0,H=!1,F=!1,V="bg_color",o="bg_color",n=null;if(T.tgWebAppData&&T.tgWebAppData.length)for(var z in L=T.tgWebAppData,U=p.urlParseQueryString(L)){var G=U[z];try{("{"==G.substr(0,1)&&"}"==G.substr(-1)||"["==G.substr(0,1)&&"]"==G.substr(-1))&&(U[z]=JSON.parse(G))}catch(e){}}var J=p.sessionStorageGet("themeParams");if(T.tgWebAppThemeParams&&T.tgWebAppThemeParams.length){var e=T.tgWebAppThemeParams;try{(t=JSON.parse(e))&&ee(t)}catch(e){}}if(J&&ee(J),e=p.sessionStorageGet("defaultColors"),T.tgWebAppDefaultColors&&T.tgWebAppDefaultColors.length){t=T.tgWebAppDefaultColors;try{(ke=JSON.parse(t))&&te(ke)}catch(e){}}e&&te(e),T.tgWebAppVersion&&(u=T.tgWebAppVersion),T.tgWebAppPlatform&&(D=T.tgWebAppPlatform),J=p.sessionStorageGet("isFullscreen"),T.tgWebAppFullscreen&&Y(!0),J&&Y("yes"==J),(t=p.sessionStorageGet("isOrientationLocked"))&&Z("yes"==t);var Q=window.innerHeight;function $(e){Q!=window.innerHeight&&(Q=window.innerHeight,S("viewportChanged",{isStateStable:!0}))}function x(e){return e.toString().replace(/^\s+|\s+$/g,"")}function S(e){var t=Array.prototype.slice.call(arguments);e=t.shift(),k.callEventCallbacks("webview:"+e,function(e){e.apply(r,t)})}function K(e,t){k.onEvent("webview:"+e,t)}function X(e,t){k.offEvent("webview:"+e,t)}function a(e,t){var r=document.documentElement;r&&r.style&&r.style.setProperty&&r.style.setProperty("--tg-"+e,t)}function Y(e){H=!!e,p.sessionStorageSet("isFullscreen",H?"yes":"no")}function Z(e){F=!!e,p.sessionStorageSet("isOrientationLocked",F?"yes":"no")}function ee(e){var t,r,o,n,i;for(r in"#1c1c1d"==e.bg_color&&e.bg_color==e.secondary_bg_color&&(e.secondary_bg_color="#2c2c2e"),e)(t=Ae(e[r]))&&(P[r]=t,"bg_color"==r&&(3==(i=(i=t).replace(/[\s#]/g,"")).length&&(i=i[0]+i[0]+i[1]+i[1]+i[2]+i[2]),o=parseInt(i.substr(0,2),16),n=parseInt(i.substr(2,2),16),i=parseInt(i.substr(4,2),16),a("color-scheme",N=Math.sqrt(o*o*.299+n*n*.587+i*i*.114)<120?"dark":"light")),a(r="theme-"+r.split("_").join("-"),t));p.sessionStorageSet("themeParams",P)}function te(e){"dark"==N?(e.bg_dark_color&&(V=e.bg_dark_color),e.header_dark_color&&(o=null,n=e.header_dark_color)):(e.bg_color&&(V=e.bg_color),e.header_color&&(o=null,n=e.header_color)),p.sessionStorageSet("defaultColors",e)}var s={};function re(e){for(var t=100;--t;){for(var r="",o="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",n=o.length,i=0;i<e;i++)r+=o[Math.floor(Math.random()*n)];if(!s[r])return s[r]={},r}throw Error("WebAppCallbackIdGenerateFailed")}var oe=!1,ne=!1,ie=!0;function ae(e){void 0!==e&&(ie=!!e.is_expanded,oe=e.height,e.is_state_stable&&(ne=e.height),S("viewportChanged",{isStateStable:!!e.is_state_stable})),e=!1!==ne?ne-g+"px":g?"calc(100vh - "+g+"px)":"100vh",a("viewport-height",!1!==oe?oe-g+"px":g?"calc(100vh - "+g+"px)":"100vh"),a("viewport-stable-height",e)}var i={top:0,bottom:0,left:0,right:0},l={top:0,bottom:0,left:0,right:0},se=!1,le=!0,ce=[],c=!1,d=!1,pe=!1,ue=!1,de=null,be=null;function fe(){de==o&&be==n||(de=o,(be=n)?k.postEvent("web_app_set_header_color",!1,{color:n}):k.postEvent("web_app_set_header_color",!1,{color_key:o}))}function ge(){return"secondary_bg_color"==V?P.secondary_bg_color:"bg_color"==V?P.bg_color:V}var me=null;function ve(){var e=ge();me!=e&&(me=e,k.postEvent("web_app_set_background_color",!1,{color:e}))}var _e="bottom_bar_bg_color";function he(){return"bottom_bar_bg_color"==_e?P.bottom_bar_bg_color||P.secondary_bg_color||"#ffffff":"secondary_bg_color"==_e?P.secondary_bg_color:"bg_color"==_e?P.bg_color:_e}var we=null;function ye(){var e=he();we!=e&&(we=e,k.postEvent("web_app_set_bottom_bar_color",!1,{color:e})),T.tgWebAppDebug&&Be()}function Ae(e){var t,r;return(r=/^\s*#([0-9a-f]{6})\s*$/i.exec(e+=""))?"#"+r[1].toLowerCase():(r=/^\s*#([0-9a-f])([0-9a-f])([0-9a-f])\s*$/i.exec(e))?("#"+r[1]+r[1]+r[2]+r[2]+r[3]+r[3]).toLowerCase():!!(r=/^\s*rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+\.{0,1}\d*))?\)\s*$/.exec(e))&&(e=parseInt(r[1]),t=parseInt(r[2]),r=parseInt(r[3]),"#"+(e=(e<16?"0":"")+e.toString(16))+(t=(t<16?"0":"")+t.toString(16))+(r<16?"0":"")+r.toString(16))}function b(e){return 0<=((e,t)=>{"string"!=typeof t&&(t=""),e=(e="string"!=typeof e?"":e).replace(/^\s+|\s+$/g,"").split("."),t=t.replace(/^\s+|\s+$/g,"").split(".");for(var r,o,n=Math.max(e.length,t.length),i=0;i<n;i++)if((r=parseInt(e[i])||0)!=(o=parseInt(t[i])||0))return o<r?1:-1;return 0})(u,e)}Ee=!1,f={},Object.defineProperty(f,"isVisible",{set:function(e){xe({is_visible:e})},get:function(){return Ee},enumerable:!0}),We=null,k.onEvent("back_button_pressed",function(){S("backButtonClicked")}),f.onClick=function(e){return Pe()&&K("backButtonClicked",e),f},f.offClick=function(e){return Pe()&&X("backButtonClicked",e),f},f.show=function(){return xe({is_visible:!0})},f.hide=function(){return xe({is_visible:!1})};var Ee,f,We,ke=f;function Te(){return{is_visible:Ee}}function Pe(){if(b("6.1"))return 1;console.warn("[Telegram.WebApp] BackButton is not supported in version "+u)}function xe(e){return Pe()&&(void 0!==e.is_visible&&(Ee=!!e.is_visible),void 0===(t=e=Te())&&(t=Te()),t=JSON.stringify(t),We!==t)&&(We=t,k.postEvent("web_app_setup_back_button",!1,e)),f;var t}var O=null,Se={},g=0;if(T.tgWebAppDebug){var Oe,O=document.createElement("tg-bottom-bar"),Ce={display:"flex",gap:"7px",font:"600 14px/18px sans-serif",width:"100%",background:he(),position:"fixed",left:"0",right:"0",bottom:"0",margin:"0",padding:"7px",textAlign:"center",boxSizing:"border-box",zIndex:"10000"};for(Oe in Ce)O.style[Oe]=Ce[Oe];document.addEventListener("DOMContentLoaded",function e(t){document.removeEventListener("DOMContentLoaded",e),document.body.appendChild(O)}),(e=document.createElement("style")).innerHTML='tg-bottom-button.shine { position: relative; overflow: hidden; } tg-bottom-button.shine:before { content:""; position: absolute; top: 0; width: 100%; height: 100%; background: linear-gradient(120deg, transparent, rgba(255, 255, 255, .2), transparent); animation: tg-bottom-button-shine 5s ease-in-out infinite; } @-webkit-keyframes tg-bottom-button-shine { 0% {left: -100%;} 12%,100% {left: 100%}} @keyframes tg-bottom-button-shine { 0% {left: -100%;} 12%,100% {left: 100%}}',O.appendChild(e)}function Be(){var e=Se.main._bottomButton,t=Se.secondary._bottomButton;e.isVisible||t.isVisible?(O.style.display="flex",g=58,e.isVisible&&t.isVisible&&("top"==t.position?(O.style.flexDirection="column-reverse",g+=51):"bottom"==t.position?(O.style.flexDirection="column",g+=51):"left"==t.position?O.style.flexDirection="row-reverse":"right"==t.position&&(O.style.flexDirection="row"))):(O.style.display="none",g=0),O.style.background=he(),document.documentElement&&(document.documentElement.style.boxSizing="border-box",document.documentElement.style.paddingBottom=g+"px"),ae()}function Ie(e){var r,t,o,n,i,a,s="main"==e,l=(a=s?(r="web_app_setup_main_button",t="main_button_pressed",o="mainButtonClicked",n="Continue",i=function(){return P.button_color||"#2481cc"},function(){return P.button_text_color||"#ffffff"}):(r="web_app_setup_secondary_button",t="secondary_button_pressed",o="secondaryButtonClicked",n="Cancel",i=he,function(){return P.button_color||"#2481cc"}),!1),c=!0,p=!1,u=!1,d=e,b=n,f=!1,g=!1,m="left",v={},_=(Object.defineProperty(v,"type",{get:function(){return d},enumerable:!0}),Object.defineProperty(v,"text",{set:function(e){v.setParams({text:e})},get:function(){return b},enumerable:!0}),Object.defineProperty(v,"color",{set:function(e){v.setParams({color:e})},get:function(){return f||i()},enumerable:!0}),Object.defineProperty(v,"textColor",{set:function(e){v.setParams({text_color:e})},get:function(){return g||a()},enumerable:!0}),Object.defineProperty(v,"isVisible",{set:function(e){v.setParams({is_visible:e})},get:function(){return l},enumerable:!0}),Object.defineProperty(v,"isProgressVisible",{get:function(){return u},enumerable:!0}),Object.defineProperty(v,"isActive",{set:function(e){v.setParams({is_active:e})},get:function(){return c},enumerable:!0}),Object.defineProperty(v,"hasShineEffect",{set:function(e){v.setParams({has_shine_effect:e})},get:function(){return p},enumerable:!0}),s||Object.defineProperty(v,"position",{set:function(e){v.setParams({position:e})},get:function(){return m},enumerable:!0}),null),h=(k.onEvent(t,A),null);if(T.tgWebAppDebug){var w,h=document.createElement("tg-bottom-button"),y={display:"none",width:"100%",height:"44px",borderRadius:"0",background:"no-repeat right center",padding:"13px 15px",textAlign:"center",boxSizing:"border-box"};for(w in y)h.style[w]=y[w];O.appendChild(h),h.addEventListener("click",A,!1),h._bottomButton=v,Se[e]=h}function A(){c&&S(o)}function E(){var e,t=v.color,r=v.textColor;return l?(e={is_visible:!0,is_active:c,is_progress_visible:u,text:b,color:t,text_color:r,has_shine_effect:p&&c&&!u},s||(e.position=m)):e={is_visible:!1},e}function W(){var e=E(),t=(void 0===(t=e)&&(t=E()),JSON.stringify(t));_!==t&&(_=t,k.postEvent(r,!1,e),T.tgWebAppDebug)&&((t=e).is_visible?(h.style.display="block",h.style.opacity=t.is_active?"1":"0.8",h.style.cursor=t.is_active?"pointer":"auto",h.disabled=!t.is_active,h.innerText=t.text,h.className=t.has_shine_effect?"shine":"",h.style.backgroundImage=t.is_progress_visible?"url('data:image/svg+xml,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewport="0 0 48 48" width="48px" height="48px"><circle cx="50%" cy="50%" stroke="'+t.text_color+'" stroke-width="2.25" stroke-linecap="round" fill="none" stroke-dashoffset="106" r="9" stroke-dasharray="56.52" rotate="-90"><animate attributeName="stroke-dashoffset" attributeType="XML" dur="360s" from="0" to="12500" repeatCount="indefinite"></animate><animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="1s" from="-90 24 24" to="630 24 24" repeatCount="indefinite"></animateTransform></circle></svg>')+"')":"none",h.style.backgroundColor=t.color,h.style.color=t.text_color):h.style.display="none",Be())}return v.setText=function(e){return v.setParams({text:e})},v.onClick=function(e){return K(o,e),v},v.offClick=function(e){return X(o,e),v},v.show=function(){return v.setParams({is_visible:!0})},v.hide=function(){return v.setParams({is_visible:!1})},v.enable=function(){return v.setParams({is_active:!0})},v.disable=function(){return v.setParams({is_active:!1})},v.showProgress=function(e){return c=!!e,u=!0,W(),v},v.hideProgress=function(){return v.isActive||(c=!0),u=!1,W(),v},v.setParams=function(e){if(void 0!==e.text){var t=x(e.text);if(!t.length)throw console.error("[Telegram.WebApp] Bottom button text is required",e.text),Error("WebAppBottomButtonParamInvalid");if(64<t.length)throw console.error("[Telegram.WebApp] Bottom button text is too long",t),Error("WebAppBottomButtonParamInvalid");b=t}if(void 0!==e.color)if(!1===e.color||null===e.color)f=!1;else{if(!(t=Ae(e.color)))throw console.error("[Telegram.WebApp] Bottom button color format is invalid",e.color),Error("WebAppBottomButtonParamInvalid");f=t}if(void 0!==e.text_color)if(!1===e.text_color||null===e.text_color)g=!1;else{if(!(t=Ae(e.text_color)))throw console.error("[Telegram.WebApp] Bottom button text color format is invalid",e.text_color),Error("WebAppBottomButtonParamInvalid");g=t}if(void 0!==e.is_visible){if(e.is_visible&&!v.text.length)throw console.error("[Telegram.WebApp] Bottom button text is required"),Error("WebAppBottomButtonParamInvalid");l=!!e.is_visible}if(void 0!==e.has_shine_effect&&(p=!!e.has_shine_effect),!s&&void 0!==e.position){if("left"!=e.position&&"right"!=e.position&&"top"!=e.position&&"bottom"!=e.position)throw console.error("[Telegram.WebApp] Bottom button posiition is invalid",e.position),Error("WebAppBottomButtonParamInvalid");m=e.position}return void 0!==e.is_active&&(c=!!e.is_active),W(),v},v}var qe,m,Me,J=Ie("main"),t=Ie("secondary"),e=(qe=!1,m={},Object.defineProperty(m,"isVisible",{set:function(e){Ue({is_visible:e})},get:function(){return qe},enumerable:!0}),Me=null,k.onEvent("settings_button_pressed",function(){S("settingsButtonClicked")}),m.onClick=function(e){return Le()&&K("settingsButtonClicked",e),m},m.offClick=function(e){return Le()&&X("settingsButtonClicked",e),m},m.show=function(){return Ue({is_visible:!0})},m.hide=function(){return Ue({is_visible:!1})},m);function je(){return{is_visible:qe}}function Le(){if(b("6.10"))return 1;console.warn("[Telegram.WebApp] SettingsButton is not supported in version "+u)}function Ue(e){return Le()&&(void 0!==e.is_visible&&(qe=!!e.is_visible),void 0===(t=e=je())&&(t=je()),t=JSON.stringify(t),Me!==t)&&(Me=t,k.postEvent("web_app_setup_settings_button",!1,e)),m;var t}var Ne,De=Ne={impactOccurred:function(e){return Re({type:"impact",impact_style:e})},notificationOccurred:function(e){return Re({type:"notification",notification_type:e})},selectionChanged:function(){return Re({type:"selection_change"})}};function Re(e){if(b("6.1")){if("impact"==e.type){if("light"!=e.impact_style&&"medium"!=e.impact_style&&"heavy"!=e.impact_style&&"rigid"!=e.impact_style&&"soft"!=e.impact_style)throw console.error("[Telegram.WebApp] Haptic impact style is invalid",e.impact_style),Error("WebAppHapticImpactStyleInvalid")}else if("notification"==e.type){if("error"!=e.notification_type&&"success"!=e.notification_type&&"warning"!=e.notification_type)throw console.error("[Telegram.WebApp] Haptic notification type is invalid",e.notification_type),Error("WebAppHapticNotificationTypeInvalid")}else if("selection_change"!=e.type)throw console.error("[Telegram.WebApp] Haptic feedback type is invalid",e.type),Error("WebAppHapticFeedbackTypeInvalid");k.postEvent("web_app_trigger_haptic_feedback",!1,e)}else console.warn("[Telegram.WebApp] HapticFeedback is not supported in version "+u);return Ne}var He,Fe=He={setItem:function(e,t,r){return Ve("saveStorageValue",{key:e,value:t},r)},getItem:function(r,o){return He.getItems([r],o?function(e,t){e?o(e):o(null,t[r])}:null)},getItems:function(e,t){return Ve("getStorageValues",{keys:e},t)},removeItem:function(e,t){return He.removeItems([e],t)},removeItems:function(e,t){return Ve("deleteStorageValues",{keys:e},t)},getKeys:function(e){return Ve("getStorageKeys",{},e)}};function Ve(e,t,r){if(b("6.9"))return Lt(e,t,r),He;throw console.error("[Telegram.WebApp] CloudStorage is not supported in version "+u),Error("WebAppMethodUnsupported")}v=ze=!1,Je=h=_=!(Ge="unknown"),Qe="",w={},Object.defineProperty(w,"isInited",{get:function(){return ze},enumerable:!0}),Object.defineProperty(w,"isBiometricAvailable",{get:function(){return ze&&v},enumerable:!0}),Object.defineProperty(w,"biometricType",{get:function(){return Ge||"unknown"},enumerable:!0}),Object.defineProperty(w,"isAccessRequested",{get:function(){return _},enumerable:!0}),Object.defineProperty(w,"isAccessGranted",{get:function(){return _&&h},enumerable:!0}),Object.defineProperty(w,"isBiometricTokenSaved",{get:function(){return Je},enumerable:!0}),Object.defineProperty(w,"deviceId",{get:function(){return Qe||""},enumerable:!0}),Ye=Xe=Ke=!($e={callbacks:[]}),k.onEvent("biometry_info_received",function(e,t){if(ze=!0,Je=t.available?(v=!0,Ge=t.type||"unknown",t.access_requested?(_=!0,h=!!t.access_granted,!!t.token_saved):h=_=!1):(v=!1,h=_=!(Ge="unknown")),Qe=t.device_id||"",0<$e.callbacks.length){for(var r=0;r<$e.callbacks.length;r++)(0,$e.callbacks[r])();$e.callbacks=[]}Ke&&(t=Ke,Ke=!1,t.callback)&&t.callback(h),S("biometricManagerUpdated")}),k.onEvent("biometry_auth_requested",function(e,t){var r,o="authorized"==t.status,t=t.token||"";Xe&&(r=Xe,Xe=!1,r.callback)&&r.callback(o,o?t:null),S("biometricAuthRequested",o?{isAuthenticated:!0,biometricToken:t}:{isAuthenticated:!1})}),k.onEvent("biometry_token_updated",function(e,t){var r=!1;v&&_&&("updated"==t.status?r=Je=!0:"removed"==t.status&&(r=!(Je=!1))),Ye&&(t=Ye,Ye=!1,t.callback)&&t.callback(r),S("biometricTokenUpdated",{isUpdated:r})}),w.init=function(e){return et()&&!ze&&(e&&$e.callbacks.push(e),k.postEvent("web_app_biometry_get_info",!1)),w},w.requestAccess=function(e,t){if(et()){if(tt(),!v)throw console.error("[Telegram.WebApp] Biometrics is not available on this device."),Error("WebAppBiometricManagerBiometricsNotAvailable");if(Ke)throw console.error("[Telegram.WebApp] Access is already requested"),Error("WebAppBiometricManagerAccessRequested");var r={};if(void 0!==e.reason){if(128<(e=x(e.reason)).length)throw console.error("[Telegram.WebApp] Biometric reason is too long",e),Error("WebAppBiometricRequestAccessParamInvalid");0<e.length&&(r.reason=e)}Ke={callback:t},k.postEvent("web_app_biometry_request_access",!1,r)}return w},w.authenticate=function(e,t){if(et()){if(tt(),!v)throw console.error("[Telegram.WebApp] Biometrics is not available on this device."),Error("WebAppBiometricManagerBiometricsNotAvailable");if(!h)throw console.error("[Telegram.WebApp] Biometric access was not granted by the user."),Error("WebAppBiometricManagerBiometricAccessNotGranted");if(Xe)throw console.error("[Telegram.WebApp] Authentication request is already in progress."),Error("WebAppBiometricManagerAuthenticationRequested");var r={};if(void 0!==e.reason){if(128<(e=x(e.reason)).length)throw console.error("[Telegram.WebApp] Biometric reason is too long",e),Error("WebAppBiometricRequestAccessParamInvalid");0<e.length&&(r.reason=e)}Xe={callback:t},k.postEvent("web_app_biometry_request_auth",!1,r)}return w},w.updateBiometricToken=function(e,t){if(et()){if(1024<(e=e||"").length)throw console.error("[Telegram.WebApp] Token is too long",e),Error("WebAppBiometricManagerTokenInvalid");if(tt(),!v)throw console.error("[Telegram.WebApp] Biometrics is not available on this device."),Error("WebAppBiometricManagerBiometricsNotAvailable");if(!h)throw console.error("[Telegram.WebApp] Biometric access was not granted by the user."),Error("WebAppBiometricManagerBiometricAccessNotGranted");if(Ye)throw console.error("[Telegram.WebApp] Token request is already in progress."),Error("WebAppBiometricManagerTokenUpdateRequested");Ye={callback:t},k.postEvent("web_app_biometry_update_token",!1,{token:e})}return w},w.openSettings=function(){if(et()){if(tt(),!v)throw console.error("[Telegram.WebApp] Biometrics is not available on this device."),Error("WebAppBiometricManagerBiometricsNotAvailable");if(!_)throw console.error("[Telegram.WebApp] Biometric access was not requested yet."),Error("WebAppBiometricManagerBiometricsAccessNotRequested");h?console.warn("[Telegram.WebApp] Biometric access was granted by the user, no need to go to settings."):k.postEvent("web_app_biometry_open_settings",!1)}return w};var ze,v,Ge,_,h,Je,Qe,w,$e,Ke,Xe,Ye,Ze=w;function et(){if(b("7.2"))return 1;console.warn("[Telegram.WebApp] BiometricManager is not supported in version "+u)}function tt(){if(!ze)throw console.error("[Telegram.WebApp] BiometricManager should be inited before using."),Error("WebAppBiometricManagerNotInited")}ot=A=y=rt=!1,E={},Object.defineProperty(E,"isInited",{get:function(){return rt},enumerable:!0}),Object.defineProperty(E,"isLocationAvailable",{get:function(){return rt&&y},enumerable:!0}),Object.defineProperty(E,"isAccessRequested",{get:function(){return A},enumerable:!0}),Object.defineProperty(E,"isAccessGranted",{get:function(){return A&&ot},enumerable:!0}),nt={callbacks:[]},it={callbacks:[]},k.onEvent("location_checked",function(e,t){if(rt=!0,ot=t.available?(y=!0,t.access_requested?(A=!0,!!t.access_granted):A=!1):A=y=!1,0<nt.callbacks.length){for(var r=0;r<nt.callbacks.length;r++)(0,nt.callbacks[r])();nt.callbacks=[]}S("locationManagerUpdated")}),k.onEvent("location_requested",function(e,t){var r;t.available?(r={latitude:t.latitude,longitude:t.longitude,altitude:null,course:null,speed:null,horizontal_accuracy:null,vertical_accuracy:null,course_accuracy:null,speed_accuracy:null},null!=t.altitude&&(r.altitude=t.altitude),null!=t.course&&(r.course=t.course%360),null!=t.speed&&(r.speed=t.speed),null!=t.horizontal_accuracy&&(r.horizontal_accuracy=t.horizontal_accuracy),null!=t.vertical_accuracy&&(r.vertical_accuracy=t.vertical_accuracy),null!=t.course_accuracy&&(r.course_accuracy=t.course_accuracy),null!=t.speed_accuracy&&(r.speed_accuracy=t.speed_accuracy)):r=null,t.available&&y&&A&&ot?st(r):(nt.callbacks.push(function(){st(r)}),k.postEvent("web_app_check_location",!1))}),E.init=function(e){return lt()&&!rt&&(e&&nt.callbacks.push(e),k.postEvent("web_app_check_location",!1)),E},E.getLocation=function(e){if(lt()){if(ct(),!y)throw console.error("[Telegram.WebApp] Location is not available on this device."),Error("WebAppLocationManagerLocationNotAvailable");it.callbacks.push(e),k.postEvent("web_app_request_location")}return E},E.openSettings=function(){if(lt()){if(ct(),!y)throw console.error("[Telegram.WebApp] Location is not available on this device."),Error("WebAppLocationManagerLocationNotAvailable");if(!A)throw console.error("[Telegram.WebApp] Location access was not requested yet."),Error("WebAppLocationManagerLocationAccessNotRequested");ot?console.warn("[Telegram.WebApp] Location access was granted by the user, no need to go to settings."):k.postEvent("web_app_open_location_settings",!1)}return E};var rt,y,A,ot,E,nt,it,at=E;function st(e){if(0<it.callbacks.length){for(var t=0;t<it.callbacks.length;t++)(0,it.callbacks[t])(e);it.callbacks=[]}null!==e&&S("locationRequested",{locationData:e})}function lt(){if(b("8.0"))return 1;console.warn("[Telegram.WebApp] LocationManager is not supported in version "+u)}function ct(){if(!rt)throw console.error("[Telegram.WebApp] LocationManager should be inited before using."),Error("WebAppLocationManagerNotInited")}pt=!1,bt=dt=ut=null,W=[],ft=[],C={},Object.defineProperty(C,"isStarted",{get:function(){return pt},enumerable:!0}),Object.defineProperty(C,"x",{get:function(){return ut},enumerable:!0}),Object.defineProperty(C,"y",{get:function(){return dt},enumerable:!0}),Object.defineProperty(C,"z",{get:function(){return bt},enumerable:!0}),k.onEvent("accelerometer_started",function(e,t){if(pt=!0,0<W.length){for(var r=0;r<W.length;r++)(0,W[r])(!0);W=[]}S("accelerometerStarted")}),k.onEvent("accelerometer_stopped",function(e,t){if(pt=!1,0<ft.length){for(var r=0;r<ft.length;r++)(0,ft[r])(!0);ft=[]}S("accelerometerStopped")}),k.onEvent("accelerometer_changed",function(e,t){ut=t.x,dt=t.y,bt=t.z,S("accelerometerChanged")}),k.onEvent("accelerometer_failed",function(e,t){if(0<W.length){for(var r=0;r<W.length;r++)(0,W[r])(!1);W=[]}S("accelerometerFailed",{error:t.error})}),C.start=function(e,t){var r;return e=e||{},mt()&&(r={},e=parseInt(e.refresh_rate||1e3),isNaN(e)||e<20||1e3<e?console.warn("[Telegram.WebApp] Accelerometer refresh_rate is invalid",e):r.refresh_rate=e,t&&W.push(t),k.postEvent("web_app_start_accelerometer",!1,r)),C},C.stop=function(e){return mt()&&(e&&ft.push(e),k.postEvent("web_app_stop_accelerometer")),C};var pt,ut,dt,bt,W,ft,C,gt=C;function mt(){if(b("8.0"))return 1;console.warn("[Telegram.WebApp] Accelerometer is not supported in version "+u)}wt=ht=_t=null,yt=vt=!1,B=[],At=[],I={},Object.defineProperty(I,"isStarted",{get:function(){return vt},enumerable:!0}),Object.defineProperty(I,"absolute",{get:function(){return yt},enumerable:!0}),Object.defineProperty(I,"alpha",{get:function(){return _t},enumerable:!0}),Object.defineProperty(I,"beta",{get:function(){return ht},enumerable:!0}),Object.defineProperty(I,"gamma",{get:function(){return wt},enumerable:!0}),k.onEvent("device_orientation_started",function(e,t){if(vt=!0,0<B.length){for(var r=0;r<B.length;r++)(0,B[r])(!0);B=[]}S("deviceOrientationStarted")}),k.onEvent("device_orientation_stopped",function(e,t){if(vt=!1,0<At.length){for(var r=0;r<At.length;r++)(0,At[r])(!0);At=[]}S("deviceOrientationStopped")}),k.onEvent("device_orientation_changed",function(e,t){yt=!!t.absolute,_t=t.alpha,ht=t.beta,wt=t.gamma,S("deviceOrientationChanged")}),k.onEvent("device_orientation_failed",function(e,t){if(0<B.length){for(var r=0;r<B.length;r++)(0,B[r])(!1);B=[]}S("deviceOrientationFailed",{error:t.error})}),I.start=function(e,t){var r,o;return e=e||{},Wt()&&(r={},o=parseInt(e.refresh_rate||1e3),isNaN(o)||o<20||1e3<o?console.warn("[Telegram.WebApp] DeviceOrientation refresh_rate is invalid",o):r.refresh_rate=o,r.need_absolute=!!e.need_absolute,t&&B.push(t),k.postEvent("web_app_start_device_orientation",!1,r)),I},I.stop=function(e){return Wt()&&(e&&At.push(e),k.postEvent("web_app_stop_device_orientation")),I};var vt,_t,ht,wt,yt,B,At,I,Et=I;function Wt(){if(b("8.0"))return 1;console.warn("[Telegram.WebApp] DeviceOrientation is not supported in version "+u)}kt=!1,xt=Pt=Tt=null,q=[],St=[],M={},Object.defineProperty(M,"isStarted",{get:function(){return kt},enumerable:!0}),Object.defineProperty(M,"x",{get:function(){return Tt},enumerable:!0}),Object.defineProperty(M,"y",{get:function(){return Pt},enumerable:!0}),Object.defineProperty(M,"z",{get:function(){return xt},enumerable:!0}),k.onEvent("gyroscope_started",function(e,t){if(kt=!0,0<q.length){for(var r=0;r<q.length;r++)(0,q[r])(!0);q=[]}S("gyroscopeStarted")}),k.onEvent("gyroscope_stopped",function(e,t){if(kt=!1,0<St.length){for(var r=0;r<St.length;r++)(0,St[r])(!0);St=[]}S("gyroscopeStopped")}),k.onEvent("gyroscope_changed",function(e,t){Tt=t.x,Pt=t.y,xt=t.z,S("gyroscopeChanged")}),k.onEvent("gyroscope_failed",function(e,t){if(0<q.length){for(var r=0;r<q.length;r++)(0,q[r])(!1);q=[]}S("gyroscopeFailed",{error:t.error})}),M.start=function(e,t){var r;return e=e||{},Ct()&&(r={},e=parseInt(e.refresh_rate||1e3),isNaN(e)||e<20||1e3<e?console.warn("[Telegram.WebApp] Gyroscope refresh_rate is invalid",e):r.refresh_rate=e,t&&q.push(t),k.postEvent("web_app_start_gyroscope",!1,r)),M},M.stop=function(e){return Ct()&&(e&&St.push(e),k.postEvent("web_app_stop_gyroscope")),M};var kt,Tt,Pt,xt,q,St,M,Ot=M;function Ct(){if(b("8.0"))return 1;console.warn("[Telegram.WebApp] Gyroscope is not supported in version "+u)}var Bt={},It=ue=!1,qt=!1,Mt=!1,jt=!1;function Lt(e,t,r){if(!b("6.9"))throw console.error("[Telegram.WebApp] Method invokeCustomMethod is not supported in version "+u),Error("WebAppMethodUnsupported");var o=re(16),e={req_id:o,method:e,params:t||{}};s[o]={callback:r},k.postEvent("web_app_invoke_custom_method",!1,e)}window.Telegram||(window.Telegram={}),Object.defineProperty(r,"initData",{get:function(){return L},enumerable:!0}),Object.defineProperty(r,"initDataUnsafe",{get:function(){return U},enumerable:!0}),Object.defineProperty(r,"version",{get:function(){return u},enumerable:!0}),Object.defineProperty(r,"platform",{get:function(){return D},enumerable:!0}),Object.defineProperty(r,"colorScheme",{get:function(){return N},enumerable:!0}),Object.defineProperty(r,"themeParams",{get:function(){return P},enumerable:!0}),Object.defineProperty(r,"isExpanded",{get:function(){return ie},enumerable:!0}),Object.defineProperty(r,"viewportHeight",{get:function(){return(!1===oe?window.innerHeight:oe)-g},enumerable:!0}),Object.defineProperty(r,"viewportStableHeight",{get:function(){return(!1===ne?window.innerHeight:ne)-g},enumerable:!0}),Object.defineProperty(r,"safeAreaInset",{get:function(){return i},enumerable:!0}),Object.defineProperty(r,"contentSafeAreaInset",{get:function(){return l},enumerable:!0}),Object.defineProperty(r,"isClosingConfirmationEnabled",{set:function(e){b("6.2")?(se=!!e,k.postEvent("web_app_setup_closing_behavior",!1,{need_confirmation:se})):console.warn("[Telegram.WebApp] Closing confirmation is not supported in version "+u)},get:function(){return se},enumerable:!0}),Object.defineProperty(r,"isVerticalSwipesEnabled",{set:function(e){b("7.7")?(le=!!e,k.postEvent("web_app_setup_swipe_behavior",!1,{allow_vertical_swipe:le})):console.warn("[Telegram.WebApp] Changing swipes behavior is not supported in version "+u)},get:function(){return le},enumerable:!0}),Object.defineProperty(r,"isFullscreen",{get:function(){return H},enumerable:!0}),Object.defineProperty(r,"isOrientationLocked",{set:function(e){b("8.0")?(Z(e),k.postEvent("web_app_toggle_orientation_lock",!1,{locked:F})):console.warn("[Telegram.WebApp] Orientation locking is not supported in version "+u)},get:function(){return F},enumerable:!0}),Object.defineProperty(r,"isActive",{get:function(){return R},enumerable:!0}),Object.defineProperty(r,"headerColor",{set:function(e){if(b("6.1")){b("6.9")||(P.bg_color&&P.bg_color==e?e="bg_color":P.secondary_bg_color&&P.secondary_bg_color==e&&(e="secondary_bg_color"));var t=null,r=null;if("bg_color"==e||"secondary_bg_color"==e)r=e;else if(b("6.9")&&!(t=Ae(e)))throw console.error("[Telegram.WebApp] Header color format is invalid",e),Error("WebAppHeaderColorInvalid");if(!b("6.9")&&"bg_color"!=r&&"secondary_bg_color"!=r)throw console.error("[Telegram.WebApp] Header color key should be one of Telegram.WebApp.themeParams.bg_color, Telegram.WebApp.themeParams.secondary_bg_color, 'bg_color', 'secondary_bg_color'",e),Error("WebAppHeaderColorKeyInvalid");o=r,n=t,fe()}else console.warn("[Telegram.WebApp] Header color is not supported in version "+u)},get:function(){return"secondary_bg_color"==o?P.secondary_bg_color:"bg_color"==o?P.bg_color:n},enumerable:!0}),Object.defineProperty(r,"backgroundColor",{set:function(e){var t;if(b("6.1")){if("bg_color"==e||"secondary_bg_color"==e)t=e;else if(!(t=Ae(e)))throw console.error("[Telegram.WebApp] Background color format is invalid",e),Error("WebAppBackgroundColorInvalid");V=t,ve()}else console.warn("[Telegram.WebApp] Background color is not supported in version "+u)},get:ge,enumerable:!0}),Object.defineProperty(r,"bottomBarColor",{set:function(e){var t;if(b("7.10")){if("bg_color"==e||"secondary_bg_color"==e||"bottom_bar_bg_color"==e)t=e;else if(!(t=Ae(e)))throw console.error("[Telegram.WebApp] Bottom bar color format is invalid",e),Error("WebAppBottomBarColorInvalid");_e=t,ye(),window.Telegram.WebApp.SecondaryButton.setParams({})}else console.warn("[Telegram.WebApp] Bottom bar color is not supported in version "+u)},get:he,enumerable:!0}),Object.defineProperty(r,"BackButton",{value:ke,enumerable:!0}),Object.defineProperty(r,"MainButton",{value:J,enumerable:!0}),Object.defineProperty(r,"SecondaryButton",{value:t,enumerable:!0}),Object.defineProperty(r,"SettingsButton",{value:e,enumerable:!0}),Object.defineProperty(r,"HapticFeedback",{value:De,enumerable:!0}),Object.defineProperty(r,"CloudStorage",{value:Fe,enumerable:!0}),Object.defineProperty(r,"BiometricManager",{value:Ze,enumerable:!0}),Object.defineProperty(r,"Accelerometer",{value:gt,enumerable:!0}),Object.defineProperty(r,"DeviceOrientation",{value:Et,enumerable:!0}),Object.defineProperty(r,"Gyroscope",{value:Ot,enumerable:!0}),Object.defineProperty(r,"LocationManager",{value:at,enumerable:!0}),r.isVersionAtLeast=b,r.setHeaderColor=function(e){r.headerColor=e},r.setBackgroundColor=function(e){r.backgroundColor=e},r.setBottomBarColor=function(e){r.bottomBarColor=e},r.enableClosingConfirmation=function(){r.isClosingConfirmationEnabled=!0},r.disableClosingConfirmation=function(){r.isClosingConfirmationEnabled=!1},r.enableVerticalSwipes=function(){r.isVerticalSwipesEnabled=!0},r.disableVerticalSwipes=function(){r.isVerticalSwipesEnabled=!1},r.lockOrientation=function(){r.isOrientationLocked=!0},r.unlockOrientation=function(){r.isOrientationLocked=!1},r.requestFullscreen=function(){if(!b("8.0"))throw console.error("[Telegram.WebApp] Method requestFullscreen is not supported in version "+u),Error("WebAppMethodUnsupported");k.postEvent("web_app_request_fullscreen")},r.exitFullscreen=function(){if(!b("8.0"))throw console.error("[Telegram.WebApp] Method exitFullscreen is not supported in version "+u),Error("WebAppMethodUnsupported");k.postEvent("web_app_exit_fullscreen")},r.addToHomeScreen=function(){if(!b("8.0"))throw console.error("[Telegram.WebApp] Method addToHomeScreen is not supported in version "+u),Error("WebAppMethodUnsupported");k.postEvent("web_app_add_to_home_screen")},r.checkHomeScreenStatus=function(e){if(!b("8.0"))throw console.error("[Telegram.WebApp] Method checkHomeScreenStatus is not supported in version "+u),Error("WebAppMethodUnsupported");e&&ce.push(e),k.postEvent("web_app_check_home_screen")},r.onEvent=function(e,t){K(e,t)},r.offEvent=function(e,t){X(e,t)},r.sendData=function(e){if(!e||!e.length)throw console.error("[Telegram.WebApp] Data is required",e),Error("WebAppDataInvalid");if(4096<(e=>{if(window.Blob)try{return new Blob([e]).size}catch(e){}for(var t=e.length,r=e.length-1;0<=r;r--){var o=e.charCodeAt(r);127<o&&o<=2047?t++:2047<o&&o<=65535&&(t+=2),56320<=o&&o<=57343&&r--}return t})(e))throw console.error("[Telegram.WebApp] Data is too long",e),Error("WebAppDataInvalid");k.postEvent("web_app_data_send",!1,{data:e})},r.switchInlineQuery=function(e,t){if(!b("6.6"))throw console.error("[Telegram.WebApp] Method switchInlineQuery is not supported in version "+u),Error("WebAppMethodUnsupported");if(!T.tgWebAppBotInline)throw console.error("[Telegram.WebApp] Inline mode is disabled for this bot. Read more about inline mode: https://core.telegram.org/bots/inline"),Error("WebAppInlineModeDisabled");if(256<(e=e||"").length)throw console.error("[Telegram.WebApp] Inline query is too long",e),Error("WebAppInlineQueryInvalid");var r=[];if(t){if(!Array.isArray(t))throw console.error("[Telegram.WebApp] Choose chat types should be an array",t),Error("WebAppInlineChooseChatTypesInvalid");for(var o={users:1,bots:1,groups:1,channels:1},n=0;n<t.length;n++){var i=t[n];if(!o[i])throw console.error("[Telegram.WebApp] Choose chat type is invalid",i),Error("WebAppInlineChooseChatTypeInvalid");2!=o[i]&&(o[i]=2,r.push(i))}}k.postEvent("web_app_switch_inline_query",!1,{query:e,chat_types:r})},r.openLink=function(e,t){var r=document.createElement("A");if(r.href=e,"http:"!=r.protocol&&"https:"!=r.protocol)throw console.error("[Telegram.WebApp] Url protocol is not supported",e),Error("WebAppTgUrlInvalid");e=r.href,t=t||{},b("6.1")?(r={url:e},b("6.4")&&t.try_instant_view&&(r.try_instant_view=!0),b("7.6")&&t.try_browser&&(r.try_browser=t.try_browser),k.postEvent("web_app_open_link",!1,r)):window.open(e,"_blank")},r.openTelegramLink=function(e,t){var r=document.createElement("A");if(r.href=e,"http:"!=r.protocol&&"https:"!=r.protocol)throw console.error("[Telegram.WebApp] Url protocol is not supported",e),Error("WebAppTgUrlInvalid");if("t.me"!=r.hostname)throw console.error("[Telegram.WebApp] Url host is not supported",e),Error("WebAppTgUrlInvalid");e=r.pathname+r.search,t=t||{},j||b("6.1")?(r={path_full:e},t.force_request&&(r.force_request=!0),k.postEvent("web_app_open_tg_link",!1,r)):location.href="https://t.me"+e},r.openInvoice=function(e,t){var r,o=document.createElement("A");if(o.href=e,"http:"!=o.protocol&&"https:"!=o.protocol||"t.me"!=o.hostname||!(o=o.pathname.match(/^\/(\$|invoice\/)([A-Za-z0-9\-_=]+)$/))||!(r=o[2]))throw console.error("[Telegram.WebApp] Invoice url is invalid",e),Error("WebAppInvoiceUrlInvalid");if(!b("6.1"))throw console.error("[Telegram.WebApp] Method openInvoice is not supported in version "+u),Error("WebAppMethodUnsupported");if(Bt[r])throw console.error("[Telegram.WebApp] Invoice is already opened"),Error("WebAppInvoiceOpened");Bt[r]={url:e,callback:t},k.postEvent("web_app_open_invoice",!1,{slug:r})},r.showPopup=function(e,t){if(!b("6.2"))throw console.error("[Telegram.WebApp] Method showPopup is not supported in version "+u),Error("WebAppMethodUnsupported");if(ue)throw console.error("[Telegram.WebApp] Popup is already opened"),Error("WebAppPopupOpened");var r,o=[],n={};if(void 0!==e.title){if(64<(r=x(e.title)).length)throw console.error("[Telegram.WebApp] Popup title is too long",r),Error("WebAppPopupParamInvalid");0<r.length&&(n.title=r)}if(!(r=void 0!==e.message?x(e.message):"").length)throw console.error("[Telegram.WebApp] Popup message is required",e.message),Error("WebAppPopupParamInvalid");if(256<r.length)throw console.error("[Telegram.WebApp] Popup message is too long",r),Error("WebAppPopupParamInvalid");if(n.message=r,void 0!==e.buttons){if(!Array.isArray(e.buttons))throw console.error("[Telegram.WebApp] Popup buttons should be an array",e.buttons),Error("WebAppPopupParamInvalid");for(var i=0;i<e.buttons.length;i++){var a=e.buttons[i],s={},l="";if(void 0!==a.id&&64<(l=a.id.toString()).length)throw console.error("[Telegram.WebApp] Popup button id is too long",l),Error("WebAppPopupParamInvalid");s.id=l;var c,l=a.type;if("ok"!=(s.type=l=void 0===l?"default":l)&&"close"!=l&&"cancel"!=l){if("default"!=l&&"destructive"!=l)throw console.error("[Telegram.WebApp] Popup button type is invalid",l),Error("WebAppPopupParamInvalid");if(!(c=void 0!==a.text?x(a.text):"").length)throw console.error("[Telegram.WebApp] Popup button text is required for type "+l,a.text),Error("WebAppPopupParamInvalid");if(64<c.length)throw console.error("[Telegram.WebApp] Popup button text is too long",c),Error("WebAppPopupParamInvalid");s.text=c}o.push(s)}}else o.push({id:"",type:"close"});if(o.length<1)throw console.error("[Telegram.WebApp] Popup should have at least one button"),Error("WebAppPopupParamInvalid");if(3<o.length)throw console.error("[Telegram.WebApp] Popup should not have more than 3 buttons"),Error("WebAppPopupParamInvalid");n.buttons=o,ue={callback:t},k.postEvent("web_app_open_popup",!1,n)},r.showAlert=function(e,t){r.showPopup({message:e},t?function(){t()}:null)},r.showConfirm=function(e,t){r.showPopup({message:e,buttons:[{type:"ok",id:"ok"},{type:"cancel"}]},t?function(e){t("ok"==e)}:null)},r.showScanQrPopup=function(e,t){if(!b("6.4"))throw console.error("[Telegram.WebApp] Method showScanQrPopup is not supported in version "+u),Error("WebAppMethodUnsupported");if(It)throw console.error("[Telegram.WebApp] Popup is already opened"),Error("WebAppScanQrPopupOpened");var r={};if(void 0!==e.text){if(64<(e=x(e.text)).length)throw console.error("[Telegram.WebApp] Scan QR popup text is too long",e),Error("WebAppScanQrPopupParamInvalid");0<e.length&&(r.text=e)}It={callback:t},k.postEvent("web_app_open_scan_qr_popup",!1,r)},r.closeScanQrPopup=function(){if(!b("6.4"))throw console.error("[Telegram.WebApp] Method closeScanQrPopup is not supported in version "+u),Error("WebAppMethodUnsupported");It=!1,k.postEvent("web_app_close_scan_qr_popup",!1)},r.readTextFromClipboard=function(e){if(!b("6.4"))throw console.error("[Telegram.WebApp] Method readTextFromClipboard is not supported in version "+u),Error("WebAppMethodUnsupported");var t=re(16),r={req_id:t};s[t]={callback:e},k.postEvent("web_app_read_text_from_clipboard",!1,r)},r.requestWriteAccess=function(e){if(!b("6.9"))throw console.error("[Telegram.WebApp] Method requestWriteAccess is not supported in version "+u),Error("WebAppMethodUnsupported");if(qt)throw console.error("[Telegram.WebApp] Write access is already requested"),Error("WebAppWriteAccessRequested");qt={callback:e},k.postEvent("web_app_request_write_access")},r.requestContact=function(e){if(!b("6.9"))throw console.error("[Telegram.WebApp] Method requestContact is not supported in version "+u),Error("WebAppMethodUnsupported");if(Mt)throw console.error("[Telegram.WebApp] Contact is already requested"),Error("WebAppContactRequested");Mt={callback:e},k.postEvent("web_app_request_phone")},r.downloadFile=function(e,t){if(!b("8.0"))throw console.error("[Telegram.WebApp] Method downloadFile is not supported in version "+u),Error("WebAppMethodUnsupported");if(jt)throw console.error("[Telegram.WebApp] Popup is already opened"),Error("WebAppDownloadFilePopupOpened");var r=document.createElement("A"),o={};if(!e||!e.url||!e.url.length)throw console.error("[Telegram.WebApp] Url is required"),Error("WebAppDownloadFileParamInvalid");if(r.href=e.url,"https:"!=r.protocol)throw console.error("[Telegram.WebApp] Url protocol is not supported",url),Error("WebAppDownloadFileParamInvalid");if(o.url=r.href,!e||!e.file_name||!e.file_name.length)throw console.error("[Telegram.WebApp] File name is required"),Error("WebAppDownloadFileParamInvalid");o.file_name=e.file_name,jt={callback:t},k.postEvent("web_app_request_file_download",!1,o)},r.shareToStory=function(e,t){if(t=t||{},!b("7.8"))throw console.error("[Telegram.WebApp] Method shareToStory is not supported in version "+u),Error("WebAppMethodUnsupported");var r=document.createElement("A");if(r.href=e,"http:"!=r.protocol&&"https:"!=r.protocol)throw console.error("[Telegram.WebApp] Media url protocol is not supported",url),Error("WebAppMediaUrlInvalid");if((e={}).media_url=r.href,void 0!==t.text){var o=x(t.text);if(2048<o.length)throw console.error("[Telegram.WebApp] Text is too long",o),Error("WebAppShareToStoryParamInvalid");0<o.length&&(e.text=o)}if(void 0!==t.widget_link){if(t.widget_link=t.widget_link||{},r.href=t.widget_link.url,"http:"!=r.protocol&&"https:"!=r.protocol)throw console.error("[Telegram.WebApp] Link protocol is not supported",url),Error("WebAppShareToStoryParamInvalid");if(o={url:r.href},void 0!==t.widget_link.name){if(48<(r=x(t.widget_link.name)).length)throw console.error("[Telegram.WebApp] Link name is too long",r),Error("WebAppShareToStoryParamInvalid");0<r.length&&(o.name=r)}e.widget_link=o}k.postEvent("web_app_share_to_story",!1,e)},r.shareMessage=function(e,t){if(!b("8.0"))throw console.error("[Telegram.WebApp] Method shareMessage is not supported in version "+u),Error("WebAppMethodUnsupported");if(c)throw console.error("[Telegram.WebApp] Share message is already opened"),Error("WebAppShareMessageOpened");c={callback:t},k.postEvent("web_app_send_prepared_message",!1,{id:e})},r.setEmojiStatus=function(e,t,r){if(t=t||{},!b("8.0"))throw console.error("[Telegram.WebApp] Method setEmojiStatus is not supported in version "+u),Error("WebAppMethodUnsupported");var o={};if(o.custom_emoji_id=e,void 0!==t.duration&&(o.duration=t.duration),d)throw console.error("[Telegram.WebApp] Emoji status is already requested"),Error("WebAppEmojiStatusRequested");d={callback:r},k.postEvent("web_app_set_emoji_status",!1,o)},r.requestEmojiStatusAccess=function(e){if(!b("8.0"))throw console.error("[Telegram.WebApp] Method requestEmojiStatusAccess is not supported in version "+u),Error("WebAppMethodUnsupported");if(pe)throw console.error("[Telegram.WebApp] Emoji status permission is already requested"),Error("WebAppEmojiStatusAccessRequested");pe={callback:e},k.postEvent("web_app_request_emoji_status_access")},r.invokeCustomMethod=function(e,t,r){Lt(e,t,r)},r.ready=function(){k.postEvent("web_app_ready")},r.expand=function(){k.postEvent("web_app_expand")},r.close=function(e){e=e||{};var t={};b("7.6")&&e.return_back&&(t.return_back=!0),k.postEvent("web_app_close",!1,t)},window.Telegram.WebApp=r,fe(),ve(),ye(),ae(),T.tgWebAppShowSettings&&e.show(),window.addEventListener("resize",$),j&&document.addEventListener("click",function(e){if(!e.metaKey&&!e.ctrlKey){for(var t=e.target;"A"!=t.tagName&&t.parentNode;)t=t.parentNode;"A"!=t.tagName||"_blank"==t.target||"http:"!=t.protocol&&"https:"!=t.protocol||"t.me"!=t.hostname||(r.openTgLink(t.href),e.preventDefault())}}),k.onEvent("theme_changed",function(e,t){t.theme_params&&(ee(t.theme_params),window.Telegram.WebApp.MainButton.setParams({}),window.Telegram.WebApp.SecondaryButton.setParams({}),fe(),ve(),ye(),S("themeChanged"))}),k.onEvent("viewport_changed",function(e,t){t.height&&(window.removeEventListener("resize",$),ae(t))}),k.onEvent("safe_area_changed",function(e,t){t&&(void 0!==t&&(void 0!==t.top&&(i.top=t.top),void 0!==t.bottom&&(i.bottom=t.bottom),void 0!==t.left&&(i.left=t.left),void 0!==t.right&&(i.right=t.right),S("safeAreaChanged")),a("safe-area-inset-top",i.top+"px"),a("safe-area-inset-bottom",i.bottom+"px"),a("safe-area-inset-left",i.left+"px"),a("safe-area-inset-right",i.right+"px"))}),k.onEvent("content_safe_area_changed",function(e,t){t&&(void 0!==t&&(void 0!==t.top&&(l.top=t.top),void 0!==t.bottom&&(l.bottom=t.bottom),void 0!==t.left&&(l.left=t.left),void 0!==t.right&&(l.right=t.right),S("contentSafeAreaChanged")),a("content-safe-area-inset-top",l.top+"px"),a("content-safe-area-inset-bottom",l.bottom+"px"),a("content-safe-area-inset-left",l.left+"px"),a("content-safe-area-inset-right",l.right+"px"))}),k.onEvent("visibility_changed",function(e,t){t.is_visible?(R=!0,S("activated")):(R=!1,S("deactivated"))}),k.onEvent("invoice_closed",function(e,t){var r;t.slug&&Bt[t.slug]&&(r=Bt[t.slug],delete Bt[t.slug],r.callback&&r.callback(t.status),S("invoiceClosed",{url:r.url,status:t.status}))}),k.onEvent("popup_closed",function(e,t){var r,o;ue&&(r=ue,ue=!1,o=null,void 0!==t.button_id&&(o=t.button_id),r.callback&&r.callback(o),S("popupClosed",{button_id:o}))}),k.onEvent("qr_text_received",function(e,t){var r,o;It&&(r=It,o=null,void 0!==t.data&&(o=t.data),r.callback&&r.callback(o)&&(It=!1,k.postEvent("web_app_close_scan_qr_popup",!1)),S("qrTextReceived",{data:o}))}),k.onEvent("scan_qr_popup_closed",function(e,t){It=!1,S("scanQrPopupClosed")}),k.onEvent("clipboard_text_received",function(e,t){var r,o;t.req_id&&s[t.req_id]&&(r=s[t.req_id],delete s[t.req_id],o=null,void 0!==t.data&&(o=t.data),r.callback&&r.callback(o),S("clipboardTextReceived",{data:o}))}),k.onEvent("write_access_requested",function(e,t){var r;qt&&(r=qt,qt=!1,r.callback&&r.callback("allowed"==t.status),S("writeAccessRequested",{status:t.status}))}),k.onEvent("phone_requested",function(e,t){var o,n,i,a,s,l,c;Mt&&(o=Mt,Mt=!1,n="sent"==t.status,i={status:t.status},n?(a=function(e){if(e&&e.length)for(var t in i.response=e,i.responseUnsafe=p.urlParseQueryString(e),i.responseUnsafe){var r=i.responseUnsafe[t];try{("{"==r.substr(0,1)&&"}"==r.substr(-1)||"["==r.substr(0,1)&&"]"==r.substr(-1))&&(i.responseUnsafe[t]=JSON.parse(r))}catch(e){}}o.callback&&o.callback(n,i),S("contactRequested",i)},l=0,c=setTimeout(function(){clearTimeout(s),a("")},3e3),function r(){Lt("getRequestedContact",{},function(e,t){t&&t.length?(clearTimeout(c),a(t)):(l+=50,s=setTimeout(r,l))})}()):(o.callback&&o.callback(n,i),S("contactRequested",i)))}),k.onEvent("file_download_requested",function(e,t){var r;jt&&(r=jt,jt=!1,t="downloading"==t.status,r.callback&&r.callback(t),S("fileDownloadRequested",{status:t?"downloading":"cancelled"}))}),k.onEvent("custom_method_invoked",function(e,t){var r,o,n;t.req_id&&s[t.req_id]&&(r=s[t.req_id],delete s[t.req_id],n=o=null,void 0!==t.result&&(o=t.result),void 0!==t.error&&(n=t.error),r.callback)&&r.callback(n,o)}),k.onEvent("fullscreen_changed",function(e,t){Y(t.is_fullscreen),S("fullscreenChanged")}),k.onEvent("fullscreen_failed",function(e,t){"ALREADY_FULLSCREEN"!=t.error||H||Y(!0),S("fullscreenFailed",{error:t.error})}),k.onEvent("home_screen_added",function(e,t){S("homeScreenAdded")}),k.onEvent("home_screen_checked",function(e,t){var r=t.status||"unknown";if(0<ce.length){for(var o=0;o<ce.length;o++)(0,ce[o])(r);ce=[]}S("homeScreenChecked",{status:r})}),k.onEvent("prepared_message_sent",function(e,t){var r;c&&(r=c,c=!1,r.callback&&r.callback(!0),S("shareMessageSent"))}),k.onEvent("prepared_message_failed",function(e,t){var r;c&&(r=c,c=!1,r.callback&&r.callback(!1),S("shareMessageFailed",{error:t.error}))}),k.onEvent("emoji_status_set",function(e,t){var r;d&&(r=d,d=!1,r.callback&&r.callback(!0),S("emojiStatusSet"))}),k.onEvent("emoji_status_failed",function(e,t){var r;d&&(r=d,d=!1,r.callback&&r.callback(!1),S("emojiStatusFailed",{error:t.error}))}),k.onEvent("emoji_status_access_requested",function(e,t){var r;pe&&(r=pe,pe=!1,r.callback&&r.callback("allowed"==t.status),S("emojiStatusAccessRequested",{status:t.status}))}),k.postEvent("web_app_request_theme"),k.postEvent("web_app_request_viewport"),k.postEvent("web_app_request_safe_area"),k.postEvent("web_app_request_content_safe_area")})();